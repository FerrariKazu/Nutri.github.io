<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutri - AI Chef</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23F4D775'/><text x='50' y='70' font-family='Arial, sans-serif' font-weight='bold' font-size='70' fill='%230F0F11' text-anchor='middle'>N</text></svg>">
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo-area">
                <i class="fa-solid fa-lemon"></i>
                <span>Nutri</span>
            </div>
            <button class="new-chat-btn" onclick="startNewChat()">
                <i class="fa-solid fa-plus"></i> New Chat
            </button>
            <div class="history-list" id="historyList">
                <!-- History items will be populated here -->
            </div>
            <div class="sidebar-footer">
                <div class="setting-toggle">
                    <input type="checkbox" id="hybridToggle" checked>
                    <label for="hybridToggle">Hybrid RAG</label>
                </div>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <main class="chat-interface">
            <div class="chat-messages" id="chatMessages">
                <!-- Welcome Message -->
                <div class="message assistant">
                    <div class="avatar"><i class="fa-solid fa-robot"></i></div>
                    <div class="content">
                        <p>Hello! I'm Nutri, your AI culinary assistant.</p>
                        <p>I can help you create recipes based on what you have, or search my database for inspiration.</p>
                        <div class="suggestions">
                            <button onclick="setInput('What can I cook with chicken and rice?')">üçó Chicken & Rice</button>
                            <button onclick="setInput('search: Italian pasta recipes')">üîç Search Pasta</button>
                            <button onclick="setInput('I have eggs, spinach, and cheese. Breakfast ideas?')">üç≥ Healthy Breakfast</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="input-area">
                <!-- Chat Mode Toggle -->
                <div class="mode-toggle">
                    <button class="mode-btn active" onclick="switchMode('recipe')" id="recipeMode">
                        <i class="fa-solid fa-utensils"></i> Recipe Generator
                    </button>
                    <button class="mode-btn" onclick="switchMode('chat')" id="chatMode">
                        <i class="fa-solid fa-comments"></i> Chat
                    </button>
                </div>

                <!-- Recipe Form (default visible) -->
                <div class="input-form" id="recipeForm">
                    <!-- Main Ingredients Field -->
                    <div class="form-group">
                        <label for="userInput">Ingredients</label>
                        <textarea id="userInput" placeholder="What ingredients do you have? (e.g., chicken, rice, garlic)" rows="2" oninput="autoResize(this)"></textarea>
                    </div>

                    <!-- Additional Fields Row -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="dislikes">Dislikes/Allergies</label>
                            <input type="text" id="dislikes" placeholder="e.g., mushrooms, nuts (or 'none')">
                        </div>

                        <div class="form-group">
                            <label for="dietaryConstraints">Dietary Constraints</label>
                            <input type="text" id="dietaryConstraints" placeholder="e.g., vegan, gluten-free (or 'none')">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="goal">Goal</label>
                            <input type="text" id="goal" placeholder="e.g., dinner, breakfast, snack">
                        </div>

                        <div class="form-group">
                            <label for="innovationLevel">Creativity Level: <span id="innovationValue">1</span></label>
                            <input type="range" id="innovationLevel" min="1" max="5" value="1" oninput="document.getElementById('innovationValue').textContent = this.value">
                            <div class="range-labels">
                                <span>Safe</span>
                                <span>Experimental</span>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button id="sendBtn" onclick="sendMessage()">
                        <i class="fa-solid fa-paper-plane"></i> Generate Recipe
                    </button>
                </div>

                <!-- Chat Form (hidden by default) -->
                <div class="input-form" id="chatForm" style="display: none;">
                    <div class="form-group">
                        <label for="chatInput">Ask me anything about food, cooking, or nutrition</label>
                        <textarea id="chatInput" placeholder="Type your question here..." rows="3" oninput="autoResize(this)"></textarea>
                    </div>
                    <button id="chatSendBtn" onclick="sendChatMessage()">
                        <i class="fa-solid fa-paper-plane"></i> Send Message
                    </button>
                </div>

                <div class="footer-text">
                    Nutri can make mistakes. Please verify important food safety information.
                </div>
            </div>
        </main>
    </div>

    <script src="js/chat.js"></script>
</body>
</html>
